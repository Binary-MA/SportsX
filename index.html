<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Sports Stream</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f8f9fa; margin: 0; padding: 0; overflow-x: hidden; }
        .instruction-box { font-size: 14px; background-color: #fffae5; border: 2px solid #ffce00; padding: 8px; margin: 10px auto; width: 90%; border-radius: 5px; font-weight: bold; }
        #playerContainer { width: 100%; max-width: 100%; height: 250px; background-color: black; margin: 10px auto; position: relative; }
        video { width: 100%; height: 100%; border: none; display: block; }
        #playlist { width: 90%; margin: 10px auto; }
        .match-item { display: flex; justify-content: space-between; align-items: center; margin: 10px 0; }
        .match-button { padding: 8px 12px; font-size: 14px; border: 1px solid #ccc; border-radius: 5px; cursor: pointer; background-color: white; color: black; flex: 1; text-align: left; }
        .external-button { padding: 5px 8px; font-size: 16px; border: 1px solid #ccc; border-radius: 5px; cursor: pointer; background-color: white; color: orange; margin-left: 5px; }
        .whatsapp-button { display: inline-block; background-color: #25D366; color: white; padding: 15px 12px; font-size: 14px; text-decoration: none; border-radius: 5px; border: 1px solid #ccc; margin-top: 10px; }
    </style>
    <!-- Include hls.js for reliable M3U8 playback -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>

<div class="instruction-box">
    Click on a match name to play. If it stops, refresh or try MX/VLC by clicking on (ðŸ”—).
</div>

<div id="playerContainer">
    <video id="videoPlayer" controls autoplay muted></video>
</div>

<div id="playlist"></div>

<a href="https://whatsapp.com/channel/0029Vb32mMt23n3ZBynqbY2l" class="whatsapp-button">
    Join WhatsApp Group for highlights
</a>

<script>
    // --- YOUR OBFUSCATED M3U8 LINKS GO HERE ---
    // Use a Base64 encoder to generate these strings from your real URLs.
    const matches = [
        {
            "name": "Live Match 1",
            "link_b64": "aHR0cHM6Ly83NDM2NDgtMzAuMTIzMDkxNzYubWUvbGl2ZS8zNTc2N18ubTN1OA=="
        },
        {
            "name": "Spain x France",
            "link_b64": "aHR0cHM6Ly9hNTkuYXpwbGF5MTIubWUvaGxzL3N0cmVhbWEyMzgyMjAvaW5kZXgubTN1OD9jc3Q9MTJmZjlhOGM0NDQwNmRmYWE0YWM3MjllMjBiZjQyMDc=" // Example encoding for the other link
        }
    ];
    // ---------------------------------------------

    const video = document.getElementById('videoPlayer');
    let hls = new Hls();

    function getDecodedUrl(encodedUrl) {
        // The atob() function decodes a Base64 string.
        try {
            return atob(encodedUrl);
        } catch (e) {
            console.error("Failed to decode Base64 string:", encodedUrl, e);
            return "";
        }
    }

    function loadVideo(encodedUrl) {
        const decodedUrl = getDecodedUrl(encodedUrl);
        if (!decodedUrl) return; // Stop if decoding fails

        if (Hls.isSupported()) {
            hls.destroy();
            hls = new Hls();
            hls.loadSource(decodedUrl);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, function () {
                video.play().catch(e => console.log("Autoplay was blocked by the browser."));
            });
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
            video.src = decodedUrl;
            video.addEventListener('loadedmetadata', function () {
                video.play().catch(e => console.log("Autoplay was blocked by the browser."));
            });
        }
    }

    function openExternal(encodedUrl) {
        const decodedUrl = getDecodedUrl(encodedUrl);
        if (!decodedUrl) return;
        window.location.href = `intent:${decodedUrl}#Intent;action=android.intent.action.VIEW;type=video/mp4;end;;`;
    }

    function renderMatches() {
        const playlistDiv = document.getElementById("playlist");
        playlistDiv.innerHTML = "";

        matches.forEach(match => {
            const matchItem = document.createElement("div");
            matchItem.classList.add("match-item");

            const matchButton = document.createElement("button");
            matchButton.classList.add("match-button");
            matchButton.textContent = match.name;
            matchButton.onclick = () => loadVideo(match.link_b64);

            const externalButton = document.createElement("button");
            externalButton.classList.add("external-button");
            externalButton.textContent = "ðŸ”—";
            externalButton.onclick = () => openExternal(match.link_b64);

            matchItem.appendChild(matchButton);
            matchItem.appendChild(externalButton);
            playlistDiv.appendChild(matchItem);
        });
    }

    window.onload = function() {
        renderMatches();
        if (matches.length > 0) {
            loadVideo(matches[0].link_b64);
        }
    };
</script>

</body>
</html>
